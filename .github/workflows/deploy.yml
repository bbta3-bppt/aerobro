name: Pengembangan Aerobro

on:
  push:
    branches:
      - master
      - main

jobs:
  deploy_socket:
    name: Deploy SocketIO
    runs-on: server19
    env:
      SOCKET_PORT: 8765
      SOCKET_ROOM_DEFAULT: ${{ secrets.SOCKET_ROOM_DEFAULT }}
    steps:
      - name: Checkout Latest Version
        uses: actions/checkout@v2

      - name: Running Socket
        run: |
          cd src_socket
          node -v
          npm -v
          npm install
          pm2 restart aerobrosocket

  update_release_draft:
    name: Update Release Draft
    runs-on: ubuntu-latest
    steps:
      - uses: release-drafter/release-drafter@v5
        env:
          GITHUB_TOKEN: ${{ secrets.WORKFLOW_TOKEN }}
